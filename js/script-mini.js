var link=document.querySelector(".write-us-btn"),popup=document.querySelector(".modal-write-us"),popup_close=popup.querySelector(".modal-close"),form=popup.querySelector(".form-write-us"),nickname=popup.querySelector("[name=name]"),email=popup.querySelector("[name=email]"),letter=popup.querySelector("[name=letter]"),map_link=document.querySelector(".map"),map_modal=document.querySelector(".modal-map"),map_close=map_modal.querySelector(".modal-close"),storage_name=localStorage.getItem("name"),storage_email=localStorage.getItem("email");link.addEventListener("click",function(e){e.preventDefault(),popup.classList.add("modal-show"),storage_name?(nickname.value=storage_name,storage_email?(email.value=storage_email,letter.focus()):email.focus()):nickname.focus()}),popup_close.addEventListener("click",function(e){e.preventDefault(),popup.classList.remove("modal-show"),popup.classList.remove("modal-error")}),window.addEventListener("keydown",function(e){27===e.keyCode&&(popup.classList.contains("modal-show")&&(popup.classList.remove("modal-show"),popup.classList.remove("modal-error")),map_modal.classList.contains("modal-show")&&map_modal.classList.remove("modal-show"))}),form.addEventListener("submit",function(e){nickname.value&&email.value&&letter.value?(localStorage.setItem("name",nickname.value),localStorage.setItem("email",email.value)):(e.preventDefault(),popup.classList.remove("modal-error"),popup.offsetWidth=popup.offsetWidth,popup.classList.add("modal-error"))}),map_link.addEventListener("click",function(e){e.preventDefault(),map_modal.classList.add("modal-show")}),map_close.addEventListener("click",function(e){e.preventDefault(),map_modal.classList.remove("modal-show")}),function(t,i){var r={_modules:{},require:function(o,n){function e(t){return function(e){a[t]=e,++r==o.length&&n.apply(null,a)}}o=[].concat.call([],o);for(var r=0,a=[],t=0,i=o.length;t<i;t++)this._modules[o[t]]&&this._modules[o[t]](e(t));return this},define:function(e,i,s){var l,c=this;return i=[].concat.call([],i),this._modules[e]=function(e){l?e(l):function(t){function e(t){return function(e){n[t]=e,++r===i.length&&o()}}function o(){s.apply(null,[function(e){t(l=e)}].concat(n))}var n=[],r=0;if(i.length)for(var a=0;a<i.length;a++)c.require(i[a],e(a));else o()}(e)},this}};r.define("main",["map-data","params"],function(e,t,a){function i(e){console&&console.error&&console.error(e)}if(t.maps&&t.maps.length&&a.testUrl){for(var s,o=document.getElementsByTagName("script"),n=o.length-1;-1<n;n--)if(-1!==(s=o[n]).src.indexOf(a.testUrl)&&!s.ctorInited){s.ctorInited=!0;break}s&&r.require(["ymaps","create-map"],function(e,t){var o,n,r=((n=document.createElement("ymaps")).setAttribute("id","ymaps"+a.tid),n.style.display="block",n.style.width=a.containerSize[0],n.style.height=a.containerSize[1],n);if(a.elementId){if(!(o=document.getElementById(a.elementId)))return void i("DOMElement #"+a.elementId+" not found.");o.appendChild(r)}else{if(!document.documentElement.contains(s))return void i("Script element was removed from document.");!function(e){for(;e;){if(e.parentNode===document.body)return!0;e=e.parentNode}return!1}(s)?document.body.appendChild(r):s.parentNode.insertBefore(r,s)}t(r),s.parentNode&&s.parentNode.removeChild(s)}),e({})}}),r.define("config",[],function(e){e(i.config)}),r.define("map-data",[],function(e){e(t)}),r.define("params",["config","map-data"],function(e,t,o){function n(e){return e?isNaN(Number(e))?e:e+"px":"100%"}var r=i.params,a=t.originalUrl.match(/\/\/(.+)$/);r.testUrl=a&&a[1],r.containerSize=[n(r.size[0]),n(r.size[1])],r.isEnterprise=-1<t.originalUrl.indexOf("//enterprise"),r.lang=(r.lang||o.maps[0]&&o.maps[0].state&&o.maps[0].state.lang||"ru_RU").replace("-","_"),r.tid=String(Number(new Date))+String(Math.round(1e6*Math.random())),r.ns=[t.namespace,r.lang,r.key.replace(/\W/g,""),r.apikey.replace(/\W/g,""),r.isEnterprise?"_ntrp":""].join("__"),e(r)}),r.define("ie-version",[],function(e){e(function(){for(var e=3,t=document.createElement("div"),o=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",o[0];);return 4<e?e:void 0}())}),r.define("js-loader",[],function(e){e(function(e,t){var o=document.getElementsByTagName("head")[0],n=document.createElement("script"),r=function(){t&&(t(),o.removeChild(n)),t=null};return n.charset="utf-8",n.src=e,o.insertBefore(n,o.firstChild),n.onreadystatechange=function(){("complete"==this.readyState||"loaded"==this.readyState)&&r()},n.onload=r,n.src=e,n})}),r.define("ymaps",["config","params","js-loader"],function(e,t,o,n){function r(){e(window[a])}var a=o.ns,i=window[a],s=a+"loader";if(i&&!window[s])i.ready(r);else if(window[s])window[s].queue.push(r);else{var l="fid"+o.tid,c=t.host;"file:"===window.location.protocol&&"/"===c.indexOf(0)&&(c="https:"+c);var p=[p=c+t.apiVersion+"/","?lang=",o.lang,"&coordorder=longlat&load=",["Map","GeoObject","geoObject.addon.balloon","map.associate.serviceGeoObjects","geoObject.addon.hint","templateLayoutFactory","domEvent.manager","control.Button","control.FullscreenControl","control.GeolocationControl","control.RouteEditor","control.RulerControl","control.SearchControl","control.TrafficControl","control.TypeSelector","control.ZoomControl","system.browser","meta","mapType.storage","option.presetStorage"].join(","),"&wizard=constructor&ns=",o.ns].join("");o.key&&(p+="&key="+o.key),o.apikey&&(p+="&apikey="+o.apikey),n(p+"&onload="+l),window[l]=function(e){e.ready(function(){!function(){var e=window[s];try{delete window[l],delete window[s]}catch(e){window[l]=window[s]=null}for(var t=0,o=e.queue.length;t<o;t++)e.queue[t]()}()})},window[s]={queue:[r],callback:window[l]}}}),r.define("check-size-component",["config","params","distribution"],function(e,d,t,u){var m;e(function(c){function p(){for(var e=document.documentElement,t=c.container.isFullscreen()?[e.clientWidth,e.clientHeight]:c.container.getSize(),o=d.minContainerSize,n="0,0"==t.toString(),r=t[0]<o[0],a=!n&&(r||t[1]<o[1]),i=["rulerControl","routeEditor","searchControl","trafficControl","geolocationControl"],s=0,l=i.length;s<l;s++)c.controls.get(i[s]).options.set("visible",!a);(c.state.get("narrowMode")||!c.options.get("suppressMapOpenBlock",!1))&&(c.state.get("narrowMode")!==r?r?u.show(c):u.hide(c):r&&u.onResize(c)),c.state.get("compactMode")!==a&&(a?(c.controls.remove("typeSelector"),c.controls.get("zoomControl").options.set({position:{top:10,left:10},size:"small"})):(c.controls.add("typeSelector"),c.controls.get("zoomControl").options.unset(["position","size"]))),n?m||(m=window.setInterval(p,200)):m&&(window.clearInterval(m),m=0),c.state.set({compactMode:a,narrowMode:r})}c.container.events.add(["fullscreenenter","fullscreenexit"],p),window.attachEvent?window.attachEvent("onresize",p):window.addEventListener("resize",p),p()})}),r.define("create-map",["config","params","map-data","check-size-component","ymaps"],function(e,t,m,f,y,g){var h=f.maps[0];e(function(e){function t(e){if(-1<e.indexOf("___sport")){var t=e.split("___");return["islands#",t[1],"Run",-1<t[0].indexOf("circle")?"CircleIcon":"Icon"].join("")}return"#"===e[0]?m.sid+""+e:e.replace(/^twirl#/,"islands#").replace(/^default#/,"islands#").replace(/Dot$/,"Icon").replace("white","gray")}var o=g.templateLayoutFactory.createClass("{{ properties.iconContent }}",{build:function(){o.superclass.build.call(this);var e=this.getData().properties.get("iconContent");if(e&&2<String(e).length){var t=this.getElement();t.style.fontSize="9px",t.style.lineHeight="16px",t.style.display="block"}}}),n={autoFitToViewport:"always",geoObjectStrokeOpacity:1,geoObjectFillOpacity:1,geoObjectStrokeColor:"ff0000e6",geoObjectStrokeWidth:5,geoObjectFillColor:"ff000099",geoObjectBalloonContentLayout:g.templateLayoutFactory.createClass("{{ properties.name|raw }}"),geoObjectIconContentLayout:o,geoObjectZIndexActive:Math.pow(10,9)+10,geoObjectZIndexHover:Math.pow(10,9)+9};m.isEnterprise||(n.searchControlProvider="yandex#search");var r=new g.Map(e,{center:h.state.center,zoom:Math.round(h.state.zoom),type:h.state.type,controls:["fullscreenControl","rulerControl","routeEditor","searchControl","trafficControl","typeSelector","zoomControl","geolocationControl"]},n);y(r),r.state.set({mapSid:h.properties.sid,mapSourceType:m.sourceType}),m.scrollZoomBehavior||r.behaviors.disable("scrollZoom");var a=f.presetStorage;for(var i in a)a.hasOwnProperty(i)&&g.option.presetStorage.add(i,a[i]);h.state.traffic&&h.state.traffic.shown&&r.controls.get("trafficControl").state.set("trafficShown",!0);for(var s=h.geoObjects.features,l=g.map.associate.serviceGeoObjects.get(r),c=0,p=s.length;c<p;c++){var d,u=s[c];u.options&&(d=t(u.options.preset||"")),l.add(new g.GeoObject({geometry:u.geometry,properties:u.properties},{preset:d,zIndex:u.options&&u.options.zIndex||c+1}))}})}),r.define("distribution",["config","params","ymaps","ymaps-counter","ie-version"],function(e,t,o,n,r,a){function i(o){function e(e){var t=e.getElement().querySelector("."+c);o.container.getSize()[0]<175?(t.style.paddingLeft="0px",t.style.backgroundImage=null):(t.style.paddingLeft="18px",t.style.backgroundImage="url("+u+")")}a<9||l&&(l.getLayoutSync()?e(l.getLayoutSync()):l.getLayout().then(e))}var s,l,c,p={ru_RU:"На большую карту",en_US:"See full-size map",ru_UA:"На большую карту",uk_UA:"На велику карту",tr_TR:"Haritalar'da aç"},d=p[o.lang]||p.ru_RU,u=["data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMjMiIHZpZXdCb3g9IjAgMCAxNCAyMyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtLjUgLS4yMjIpIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik01LjUgMjMuMjIybDUuNTM1LTcuNTdzMS42LTIuMTg1IDIuNjEtNC4xNWMxLjAxLTEuOTY2Ljg0NS00LjI4Ljg0NS00LjI4TDggMTMuMiA1LjUgMjMuMjJ6IiBmaWxsPSIjQ0QwMDAwIi8+PGNpcmNsZSBmaWxsPSIjRTAwIiBjeD0iNy41IiBjeT0iNy4yMjIiIHI9IjciLz48ZWxsaXBzZSBmaWxsPSIjRkZGIiBjeD0iNy41IiBjeT0iNy4yMjIiIHJ4PSIzIiByeT0iMyIvPjwvZz48L3N2Zz4="].join(""),m="background-size: 10px 16px; background-repeat: no-repeat; background-position: left center;display: inline-block;";a<9&&(m=""),e({show:function(e){e.options.set({copyrightLogoVisible:!1,suppressMapOpenBlock:!0}),function(e){function t(e){var t=e.getElement();t&&t.firstChild&&t.parentNode&&(t.firstChild.style.width="100%",t.firstChild.firstChild&&(t.firstChild.firstChild.style.padding="0px"))}c="cnst_"+ +new Date,l=new n.control.Button({data:{content:'<ymaps style="display: block; text-align:center;"><ymaps class="'+c+'" style="'+m+'">'+d+"</ymaps></ymaps>"},options:{maxWidth:"99999",selectOnClick:!1}}),e.controls.add(l,{position:{left:10,right:10,bottom:5}}),l.getLayoutSync()?t(l.getLayoutSync()):l.getLayout().then(t),e.panes.get("copyrights").getElement().style.marginBottom="29px",i(e)}(e),e.controls.remove("fullscreenControl"),l.events.add("click",function(){var e;window.open([t.mapHost,"?um=",o.sourceType,":",o.sid,"&source=constructor"].join("")),e="mapsButton-constructor.smallMap",r.countByKey("distribution",[e,n.system.browser.platform,n.meta.version.replace(/\W/g,"_")].join("."))})},onResize:function(e){i(e)},hide:function(e){l&&e.controls.remove(l),e.controls.add("fullscreenControl"),e.panes.get("copyrights").getElement().style.marginBottom="0px",e.options.unset(["copyrightLogoVisible","suppressMapOpenBlock"]),s&&(s.removeAll(),s=null)}})}),r.define("ymaps-counter",["ymaps"],function(e,t){var r;e({countByKey:function(o,n){r?r.then(function(e){e.countByKey(o,n)}):r=t.modules.require("yandex.counter").then(function(e){var t=e[0];return t.countByKey(o,n),t})}})}),r.require("main",function(){})}({ymj:"1.0",maps:[{properties:{sid:"RDUQfAdTpPxf2D-3Zi5kxJBx49zXnQ6N",authorUid:"45900345",updated:1473385e3,created:1472197045,favourite:0,access:"public",name:"device-map",description:""},state:{center:[37.53213918936342,55.68725814973584],zoom:15,size:[960,560],lang:"",type:"yandex#map",traffic:{shown:!1}},geoObjects:{type:"FeatureCollection",features:[{type:"Feature",properties:{name:"Россия, Москва, улица Строителей, 15",description:""},geometry:{type:"Point",coordinates:[37.529654,55.68698]},options:{preset:"islands#redDotIcon"}}]}}]},{config:{host:"https://api-maps.yandex.ru/",originalUrl:"https://api-maps.yandex.ru/services/constructor/1.0/js/?sid=RDUQfAdTpPxf2D-3Zi5kxJBx49zXnQ6N&width=960&height=560&id=yandex-map&lang=ru_RU&sourceType=constructor&scroll=true",namespace:"ymaps_ctor",apiVersion:"2.1.41",minContainerSize:[320,200],mapHost:"https://yandex.ru/maps/"},params:{scrollZoomBehavior:!0,size:["960","560"],sid:"RDUQfAdTpPxf2D-3Zi5kxJBx49zXnQ6N",elementId:"yandex-map",lang:"ru_RU",sourceType:"constructor",key:"",apikey:"",buttonType:3}});